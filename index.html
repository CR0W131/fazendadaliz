<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fazendinha da Liz</title>
    
    <!-- Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tone.js para sons --><script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    
    <!-- Google Fonts (Patrick Hand para um visual divertido) --><link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    
    <!-- Configura√ß√£o do Tailwind para usar a fonte Patrick Hand e anima√ß√µes --><script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'patrick': ['"Patrick Hand"', 'cursive'],
                    },
                    keyframes: {
                        // Anima√ß√£o de brilho para quando acertar
                        match: {
                            '0%, 100%': { transform: 'scale(1)', boxShadow: '0 0 5px rgba(74, 222, 128, 0.5)' },
                            '50%': { transform: 'scale(1.05)', boxShadow: '0 0 20px rgba(74, 222, 128, 1)' },
                        },
                        // Anima√ß√£o de "balan√ßar" para o modal
                        boing: {
                            '0%, 100%': { transform: 'scale(1)' },
                            '25%': { transform: 'scale(0.95)' },
                            '50%': { transform: 'scale(1.05)' },
                        },
                        // Anima√ß√£o de "confetti" para o match
                        confetti: {
                            '0%': { transform: 'translateY(0) rotateZ(0deg)', opacity: '1' },
                            '100%': { transform: 'translateY(-1000px) rotateZ(1080deg)', opacity: '0' },
                        }
                    },
                    animation: {
                        'match': 'match 0.5s ease-in-out',
                        'boing': 'boing 0.5s ease-out',
                        'confetti': 'confetti 3s forwards',
                        // animate-pulse √© padr√£o do Tailwind
                    }
                },
            },
        };
    </script>

    <!-- Estilos CSS customizados para o efeito de "flip" da carta --><style>
        /* Define as cores-tema como vari√°veis CSS para f√°cil manuten√ß√£o */
        :root {
            --bg-color: #f0fdfa; /* emerald-50 */
            --primary-text: #db2777; /* Cor-tema rosa para o texto principal */
            --card-back-color: #f59e0b; /* amber-500 */
            --card-back-icon: #b45309; /* amber-700 */
            --card-front-color: #e0f2fe; /* sky-100 */
            --accent-color: #ec4899; /* pink-500 */
        }
    
        body {
            font-family: 'Patrick Hand', 'cursive';
            background-color: var(--bg-color);
            color: var(--primary-text);
        }

        /* Container da carta para perspectiva 3D */
        .card {
            perspective: 1000px;
            aspect-ratio: 1 / 1; /* Garante que a carta seja sempre quadrada */
        }

        /* O miolo da carta que gira */
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        /* Vira o miolo quando a carta tem a classe 'is-flipped' */
        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }

        /* Estilo comum para frente e verso */
        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; /* Safari */
            backface-visibility: hidden;
            border-radius: 0.75rem; /* rounded-xl */
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Verso da carta (vis√≠vel por padr√£o) */
        .card-back {
            background-color: var(--card-back-color);
            color: var(--card-back-icon);
            font-size: 2.5rem; /* Ajuste o tamanho do √≠cone */
            border: 4px solid var(--card-back-icon);
        }

        /* Frente da carta (vis√≠vel ap√≥s girar) */
        .card-front {
            background-color: var(--card-front-color);
            transform: rotateY(180deg);
            font-size: 2.5rem; /* Tamanho inicial do emoji */
        }
        
        /* Media query para emojis maiores em telas maiores */
        @media (min-width: 640px) {
            .card-front {
                font-size: 3rem;
            }
        }
        
        /* Anima√ß√£o de "par encontrado" */
        .card.is-matched .card-inner {
            animation: match 0.5s ease-in-out;
        }

        /* Estilos para o efeito de confetti */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--color);
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
            animation: confetti 3s forwards;
            opacity: 0; /* Come√ßa invis√≠vel e se torna vis√≠vel com a anima√ß√£o */
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen p-2 sm:p-4">

    <main class="w-full max-w-4xl mx-auto">
        <!-- T√≠tulo do Jogo --><h1 class="text-6xl sm:text-8xl font-bold text-center text-pink-600 mb-4 drop-shadow-md">
            Fazendinha da Liz
        </h1>

        <!-- Painel de Status (Tempo, Jogadas, Bot√£o 'L' e Reiniciar) -->
        <div class="flex flex-col sm:flex-row justify-between items-center bg-white/80 backdrop-blur-sm p-3 sm:p-4 rounded-xl shadow-lg mb-4 text-xl sm:text-2xl gap-4">
            
            <!-- Status Info (Sempre primeiro/esquerda) -->
            <div class="flex gap-4 text-pink-700 w-full sm:w-auto justify-center sm:justify-start">
                <div class="font-bold">Tempo: <span id="time" class="font-normal">0</span>s</div>
                <div class="font-bold">Jogadas: <span id="moves" class="font-normal">0</span></div>
            </div>

            <!-- NOVO Bot√£o Pulsante 'L' (Centralizado) -->
            <div class="flex justify-center flex-grow sm:flex-grow-0 w-full sm:w-auto order-3 sm:order-2">
                <button id="liz-info-btn" class="w-16 h-16 rounded-full text-3xl font-bold flex items-center justify-center transition-all duration-300 transform hover:scale-110 
                    /* Estilos aprimorados: Gradiente, borda branca, sombra pulsante */
                    bg-gradient-to-br from-yellow-300 to-pink-400 text-pink-800 border-4 border-white 
                    shadow-[0_0_20px_rgba(255,100,150,0.8)] animate-pulse">
                    L
                </button>
            </div>

            <!-- Bot√£o Reiniciar (Sempre por √∫ltimo/direita) -->
            <button id="restart-btn" class="w-full sm:w-auto bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105 order-2 sm:order-3">
                Reiniciar Jogo
            </button>
        </div>

        <!-- Tabuleiro do Jogo (8x4) --><div id="game-board" class="grid grid-cols-4 sm:grid-cols-8 gap-3 sm:gap-4">
            <!-- As cartas ser√£o geradas pelo JavaScript aqui --></div>
    </main>

    <!-- Modal de Vit√≥ria (escondido por padr√£o) --><div id="win-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div id="win-modal-content" class="bg-white p-8 rounded-2xl shadow-2xl text-center text-pink-800 max-w-sm transform scale-0 transition-transform duration-300">
            <h2 class="text-6xl font-patrick font-bold text-yellow-500 mb-4">Parab√©ns!</h2>
            <img src="https://i.imgur.com/mWfbZSa.png" alt="[Imagem de porquinho da fazenda comemorando]" class="mx-auto rounded-lg mb-4 w-3/4">
            <p class="text-2xl mb-2">Voc√™ completou o jogo!</p>
            <p class="text-xl mb-1">Seu tempo: <span id="final-time" class="font-bold">0</span>s</p>
            <p class="text-xl mb-6">Total de jogadas: <span id="final-moves" class="font-bold">0</span></p>
            <button id="play-again-btn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 text-xl rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                Jogar de Novo
            </button>
        </div>
    </div>

    <!-- NOVO Modal para a Anima√ß√£o da Liz (escondido por padr√£o) -->
    <div id="liz-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50">
        <div id="liz-modal-content" class="bg-white p-4 sm:p-6 rounded-2xl shadow-2xl text-center text-pink-800 max-w-lg w-full transform scale-0 transition-transform duration-300">
            <h2 class="text-4xl font-patrick font-bold text-pink-600 mb-4">Mensagem da Liz</h2>
            
            <!-- V√≠deo para carregar a anima√ß√£o da Liz (MP4) -->
            <div class="aspect-video w-full mb-4">
                <video
                    src="https://i.imgur.com/C4oh5yy.mp4" 
                    autoplay 
                    loop 
                    muted 
                    playsinline
                    class="w-full h-full rounded-xl border-4 border-pink-300 object-cover"
                ></video>
            </div>

            <button id="close-liz-modal-btn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-6 text-xl rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                Voltar ao Jogo
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Elementos do DOM
            const gameBoard = document.getElementById('game-board');
            const movesEl = document.getElementById('moves');
            const timeEl = document.getElementById('time');
            const restartBtn = document.getElementById('restart-btn');
            const winModal = document.getElementById('win-modal');
            const winModalContent = document.getElementById('win-modal-content');
            const finalTimeEl = document.getElementById('final-time');
            const finalMovesEl = document.getElementById('final-moves');
            const playAgainBtn = document.getElementById('play-again-btn');

            // NOVOS Elementos do DOM (Liz Info)
            const lizInfoBtn = document.getElementById('liz-info-btn');
            const lizModal = document.getElementById('liz-modal');
            const lizModalContent = document.getElementById('liz-modal-content');
            const closeLizModalBtn = document.getElementById('close-liz-modal-btn');


            // --- Configura√ß√£o dos Animais e Sons ---
            
            // 16 pares
            const animalData = [
                { emoji: 'üêÑ', id: 'vaca' },
                { emoji: 'üêé', id: 'cavalo' },
                { emoji: 'üêñ', id: 'porco' },
                { emoji: 'üêî', id: 'galinha' },
                { emoji: 'ü¶Ü', id: 'pato' },
                { emoji: 'üêë', id: 'ovelha' },
                { emoji: 'üêê', id: 'cabra' },
                { emoji: 'üêï', id: 'cachorro' },
                { emoji: 'üêà', id: 'gato' },
                { emoji: 'üêá', id: 'coelho' },
                { emoji: 'üê∏', id: 'sapo' },
                { emoji: 'ü¶É', id: 'peru' },
                { emoji: 'üêì', id: 'galo' },
                { emoji: 'üêÅ', id: 'rato' },
                { emoji: 'üê¶', id: 'passaro' },
                { emoji: 'üêù', id: 'abelha' },
            ];

            // Configura√ß√£o dos sintetizadores e sons
            // VERS√ÉO MAIS INFANTIL: Sons mais agudos e suaves (tipo caixinha de m√∫sica/brinquedo)
            const synths = {
                'vaca': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'cavalo': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'porco': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'galinha': new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'pato': new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'ovelha': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'cabra': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'cachorro': new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'gato': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, release: 0.3 } }).toDestination(),
                'coelho': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'sapo': new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'peru': new Tone.PluckSynth({ attackNoise: 0.1, dampening: 4000, resonance: 0.7 }).toDestination(),
                'galo': new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'rato': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, release: 0.1 } }).toDestination(),
                'passaro': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
                'abelha': new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.01, release: 0.2 } }).toDestination(),
            };

            const soundNotes = {
                'vaca': 'C5',
                'cavalo': 'G4',
                'porco': 'E4',
                'galinha': 'C6',
                'pato': 'A5',
                'ovelha': 'F4',
                'cabra': 'G#4',
                'cachorro': 'A4',
                'gato': 'E6',
                'coelho': 'B5',
                'sapo': 'D4',
                'peru': 'F#4',
                'galo': 'B4',
                'rato': 'G6',
                'passaro': 'D6',
                'abelha': 'A6',
            };

            // Synth para o som de vit√≥ria ao acertar um par
            const winPairSynth = new Tone.Synth().toDestination();
            winPairSynth.envelope.attack = 0.02;
            winPairSynth.envelope.decay = 0.2;
            winPairSynth.envelope.sustain = 0.05;
            winPairSynth.envelope.release = 0.3;
            
            // Cores para o confetti
            const confettiColors = ['#fde047', '#f87171', '#a78bfa', '#60a5fa', '#34d399']; // Amarelo, Vermelho, Roxo, Azul, Verde

            // Estado do Jogo
            let cards = [];
            let flippedCards = [];
            let matchedPairs = 0;
            let moves = 0;
            let timerInterval = null;
            let gameInProgress = true; // Previne cliques m√∫ltiplos

            // --- Fun√ß√µes do Jogo ---

            // Fun√ß√£o para tocar som
            async function playSound(animalId) {
                // Inicia o contexto de √°udio no primeiro clique (requerido pelos navegadores)
                if (Tone.context.state !== 'running') {
                    await Tone.start();
                }

                const synth = synths[animalId];
                const note = soundNotes[animalId];
                if (!synth || !note) return;
                
                const now = Tone.now();

                // Som padr√£o mais curto e infantil
                const duration = synth instanceof Tone.PluckSynth ? '0.2s' : '0.1s';
                synth.triggerAttackRelease(note, duration, now);
            }

            // Fun√ß√£o para embaralhar o array
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // Fun√ß√£o para criar o tabuleiro
            function createBoard() {
                // Duplica os animais para formar pares e embaralha
                cards = shuffle([...animalData, ...animalData]);
                gameBoard.innerHTML = ''; // Limpa o tabuleiro anterior

                cards.forEach((animal, index) => {
                    const card = document.createElement('div');
                    card.classList.add('card');
                    card.dataset.id = animal.id; // Usa o ID para checagem
                    card.dataset.index = index; // ID √∫nico para a carta

                    card.innerHTML = `
                        <div class="card-inner">
                            <div class="card-back">
                                <span>‚ùì</span>
                            </div>
                            <div class="card-front" style="font-size: clamp(2rem, 10vw, 3.5rem);">
                                ${animal.emoji}
                            </div>
                        </div>
                    `;
                    
                    card.addEventListener('click', () => handleCardClick(card));
                    gameBoard.appendChild(card);
                });
            }

            // Fun√ß√£o para iniciar/reiniciar o jogo
            function startGame() {
                gameInProgress = true;
                moves = 0;
                matchedPairs = 0;
                flippedCards = [];
                movesEl.textContent = moves;
                
                // Para o timer antigo
                clearInterval(timerInterval);
                winModal.classList.add('hidden');
                winModalContent.classList.add('scale-0');
                winModalContent.classList.remove('scale-100', 'animate-boing');
                timeEl.textContent = 0;

                // Inicia novo timer
                let startTime = Date.now();
                timerInterval = setInterval(() => {
                    const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
                    timeEl.textContent = elapsedTime;
                }, 1000);

                createBoard();
            }
            
            // NOVA Fun√ß√£o para reiniciar o timer sem resetar o tempo total (para quando fecha o modal)
            function restartTimerFromCurrentTime() {
                const currentSeconds = parseInt(timeEl.textContent, 10);
                let startTime = Date.now() - (currentSeconds * 1000);
                
                timerInterval = setInterval(() => {
                    const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
                    timeEl.textContent = elapsedTime;
                }, 1000);
            }


            // Fun√ß√£o para lidar com o clique na carta
            function handleCardClick(card) {
                // N√£o faz nada se o jogo estiver travado, a carta j√° estiver virada ou for um par
                if (!gameInProgress || card.classList.contains('is-flipped') || card.classList.contains('is-matched')) {
                    return;
                }
                
                // Vira a carta
                card.classList.add('is-flipped');
                playSound(card.dataset.id);
                flippedCards.push(card);

                // Se duas cartas estiverem viradas, checa se s√£o um par
                if (flippedCards.length === 2) {
                    checkForMatch();
                }
            }

            // Fun√ß√£o para checar se as duas cartas viradas s√£o um par
            function checkForMatch() {
                gameInProgress = false; // Trava o tabuleiro
                moves++;
                movesEl.textContent = moves;

                const [card1, card2] = flippedCards;

                // √â um par!
                if (card1.dataset.id === card2.dataset.id) {
                    card1.classList.add('is-matched');
                    card2.classList.add('is-matched');
                    matchedPairs++;
                    flippedCards = [];
                    gameInProgress = true; // Destrava o tabuleiro
                    
                    // Toca som de vit√≥ria para o par
                    playWinPairSound();
                    // Cria efeito de confetti
                    createConfetti(card1.getBoundingClientRect().x + card1.offsetWidth / 2, card1.getBoundingClientRect().y + card1.offsetHeight / 2);
                    createConfetti(card2.getBoundingClientRect().x + card2.offsetWidth / 2, card2.getBoundingClientRect().y + card2.offsetHeight / 2);


                    // Checa condi√ß√£o de vit√≥ria
                    if (matchedPairs === animalData.length) {
                        endGame();
                    }
                } 
                // N√£o √© um par
                else {
                    setTimeout(() => {
                        card1.classList.remove('is-flipped');
                        card2.classList.remove('is-flipped');
                        flippedCards = [];
                        gameInProgress = true; // Destrava o tabuleiro
                    }, 1000); // Espera 1 segundo
                }
            }

            // Fun√ß√£o para tocar um som de vit√≥ria quando um par √© encontrado
            async function playWinPairSound() {
                if (Tone.context.state !== 'running') {
                    await Tone.start();
                }
                const now = Tone.now();
                winPairSynth.triggerAttackRelease('C5', '0.1s', now);
                winPairSynth.triggerAttackRelease('E5', '0.1s', now + 0.1);
                winPairSynth.triggerAttackRelease('G5', '0.1s', now + 0.2);
            }

            // Fun√ß√£o para criar o efeito de confetti
            function createConfetti(x, y) {
                for (let i = 0; i < 15; i++) { // Cria 15 peda√ßos de confetti
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    
                    // Posi√ß√£o inicial levemente aleat√≥ria em torno do centro da carta
                    confetti.style.left = `${x + (Math.random() - 0.5) * 40}px`;
                    confetti.style.top = `${y + (Math.random() - 0.5) * 40}px`;
                    
                    // Cor aleat√≥ria
                    confetti.style.setProperty('--color', confettiColors[Math.floor(Math.random() * confettiColors.length)]);
                    
                    // Tamanho aleat√≥rio
                    const size = Math.random() * 8 + 4; // Entre 4px e 12px
                    confetti.style.width = `${size}px`;
                    confetti.style.height = `${size}px`;
                    
                    // Atraso de anima√ß√£o para um efeito mais espalhado
                    confetti.style.animationDelay = `${Math.random() * 0.5}s`;

                    document.body.appendChild(confetti);

                    // Remove o confetti ap√≥s a anima√ß√£o
                    confetti.addEventListener('animationend', () => {
                        confetti.remove();
                    });
                }
            }


            // Fun√ß√£o para finalizar o jogo (mostrar modal de vit√≥ria)
            function endGame() {
                clearInterval(timerInterval); // Para o timer
                
                // Preenche os dados do modal
                finalTimeEl.textContent = timeEl.textContent;
                finalMovesEl.textContent = moves;
                
                // Mostra o modal com anima√ß√£o
                winModal.classList.remove('hidden');
                setTimeout(() => {
                    winModalContent.classList.remove('scale-0');
                    winModalContent.classList.add('scale-100', 'animate-boing');
                }, 100); // Pequeno delay para a anima√ß√£o funcionar
            }
            
            // Fun√ß√£o para mostrar o modal da Liz
            function showLizModal() {
                // Pausa o timer
                clearInterval(timerInterval); 

                lizModal.classList.remove('hidden');
                setTimeout(() => {
                    lizModalContent.classList.remove('scale-0');
                    lizModalContent.classList.add('scale-100', 'animate-boing');
                }, 100);
            }

            // Fun√ß√£o para esconder o modal da Liz
            function hideLizModal() {
                lizModalContent.classList.remove('scale-100', 'animate-boing');
                lizModalContent.classList.add('scale-0');
                
                setTimeout(() => {
                    lizModal.classList.add('hidden');
                    // Retoma o timer se o jogo n√£o estiver terminado
                    if (matchedPairs < animalData.length) {
                        restartTimerFromCurrentTime();
                    }
                }, 300); // Espera a anima√ß√£o de sa√≠da
            }


            // --- Event Listeners ---
            restartBtn.addEventListener('click', startGame);
            playAgainBtn.addEventListener('click', startGame);
            
            // Event Listeners para o novo bot√£o e modal
            lizInfoBtn.addEventListener('click', showLizModal);
            closeLizModalBtn.addEventListener('click', hideLizModal);


            // Inicia o jogo pela primeira vez
            startGame();
        });
    </script>
</body>
</html>

